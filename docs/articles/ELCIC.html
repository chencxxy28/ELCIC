<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ELCIC">
<title>ELCIC • ELCIC</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ELCIC">
<meta property="og:description" content="ELCIC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ELCIC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/ELCIC.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chencxxy28/ELCIC/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ELCIC</h1>
                        <h4 data-toc-skip class="author">Chixiang
Chen</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/chencxxy28/ELCIC/blob/HEAD/vignettes/ELCIC.Rmd" class="external-link"><code>vignettes/ELCIC.Rmd</code></a></small>
      <div class="d-none name"><code>ELCIC.Rmd</code></div>
    </div>

    
    
<p><strong>ELCIC</strong> is a robust and consistent model selection
criterion based upon the empirical likelihood function which is
data-driven. In particular, this framework adopts plug-in estimators
that can be achieved by solving external estimating equations, not
limited to the empirical likelihood, which avoids potential
computational convergence issues and allows versatile applications, such
as generalized linear models, generalized estimating equations,
penalized regressions, and so on. The formulation of our proposed
criterion is initially derived from the asymptotic expansion of the
marginal likelihood under the variable selection framework, but more
importantly, the consistent model selection property is established
under a general context.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"chencxxy28/ELCIC"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chencxxy28/ELCIC" class="external-link">ELCIC</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'MASS' was built under R version 4.1.2</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span></code></pre></div>
<p>We provide some basic tutorial for illustrating the usage of
<strong>ELCIC</strong> package. More technical details are referred to
the <a href="https://arxiv.org/pdf/2006.13281.pdf" class="external-link">Chen et
al. (2021)</a>. In the following, we list three applications of ELCIC,
which is the variable selection in generalized linear model, model
selection in longitudinal data, and model selection in longitudinal data
with missingness.</p>
</div>
<div class="section level2">
<h2 id="variable-selection-in-generalized-linear-models-glms">Variable Selection in Generalized Linear Models (GLMs)<a class="anchor" aria-label="anchor" href="#variable-selection-in-generalized-linear-models-glms"></a>
</h2>
<p>First, let us generate a pseudo data from negative binomial
distribution with overdispersion parameter (ov) equal to 8. We provide a
function <code>glm.generator</code> to generate responses and
covariates. Different outcome distributions are considered in this
function including Gaussian, Poisson, Binomial, and Negative Binomial
distributions.</p>
<p>We first test how ELCIC works when the distribution is correctly
specified. The outcomes are generated from Poisson distribution. Then,
we consider seven candidate models with different covariate combinations
and compare ELCIC with most commonly used criteria including <a href="https://ieeexplore.ieee.org/document/1100705" class="external-link">AIC</a>, <a href="https://projecteuclid.org/journals/annals-of-statistics/volume-6/issue-2/Estimating-the-Dimension-of-a-Model/10.1214/aos/1176344136.full" class="external-link">BIC</a>,
and <a href="https://www.jstor.org/stable/2337290?seq=1" class="external-link">GIC</a>. The
function <code>ELCIC.glm</code> can produce the values of ELCIC, AIC,
BIC, and GIC given a candidate model. The selection rates from four
criteria are present based on 20 Monte Carlo runs (may take 1-2 minutes
to run).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">28582</span><span class="op">)</span></span>
<span><span class="va">inter.total</span><span class="op">=</span><span class="fl">20</span></span>
<span><span class="va">count.matrix</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">4</span>,ncol<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">candidate.sets</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">count.matrix</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ELCIC"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"GIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">count.matrix</span><span class="op">)</span><span class="op">&lt;-</span><span class="va">candidate.sets</span></span>
<span><span class="va">samplesize</span><span class="op">&lt;-</span><span class="fl">100</span></span>
<span><span class="va">ov</span><span class="op">=</span><span class="fl">2</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">iter</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">inter.total</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>    <span class="co">#generate data</span></span>
<span><span class="va">simulated.data</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/glm.generator.html">glm.generator</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,samplesize<span class="op">=</span><span class="va">samplesize</span>,rho<span class="op">=</span><span class="fl">0.5</span>,dist<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="va">simulated.data</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="va">simulated.data</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">criterion.all</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ELCIC.glm.html">ELCIC.glm</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,candidate.sets<span class="op">=</span><span class="va">candidate.sets</span>,name.var<span class="op">=</span><span class="cn">NULL</span>,dist<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print(iter)</span></span>
<span><span class="va">index.used</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">criterion.all</span>,<span class="fl">1</span>,<span class="va">which.min</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">count.matrix</span><span class="op">[</span><span class="va">index.used</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">count.matrix</span><span class="op">[</span><span class="va">index.used</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span><span class="va">count.matrix</span><span class="op">/</span><span class="va">inter.total</span></span></code></pre></div>
<p>Based on the results, we find ELCIC and BIC has the best performance
due to the highest selection rate among others. It shows that ELCIC is
as powerful as BIC when the distribution is correctly specified. Next,
we consider the situation where the AIC, BIC, and GIC is based on
misspecified distribution. Accordingly, we generate outcomes from
Negative Binomial distribution with the dispersion parameter equal to 2,
while AIC, BIC, and GIC consider Poisson distribution as the input (may
take 1-2 minutes to run).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">28582</span><span class="op">)</span></span>
<span><span class="va">inter.total</span><span class="op">=</span><span class="fl">20</span></span>
<span><span class="va">count.matrix</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">4</span>,ncol<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">candidate.sets</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">count.matrix</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ELCIC"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"GIC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">count.matrix</span><span class="op">)</span><span class="op">&lt;-</span><span class="va">candidate.sets</span></span>
<span><span class="va">samplesize</span><span class="op">&lt;-</span><span class="fl">100</span></span>
<span><span class="va">ov</span><span class="op">=</span><span class="fl">2</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">iter</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">inter.total</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>    <span class="co">#generate data</span></span>
<span><span class="va">simulated.data</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/glm.generator.html">glm.generator</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,samplesize<span class="op">=</span><span class="va">samplesize</span>,rho<span class="op">=</span><span class="fl">0.5</span>,dist<span class="op">=</span><span class="st">"NB"</span>,ov<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="va">simulated.data</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="va">simulated.data</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">criterion.all</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ELCIC.glm.html">ELCIC.glm</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,candidate.sets<span class="op">=</span><span class="va">candidate.sets</span>,name.var<span class="op">=</span><span class="cn">NULL</span>,dist<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print(iter)</span></span>
<span><span class="va">index.used</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">criterion.all</span>,<span class="fl">1</span>,<span class="va">which.min</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">count.matrix</span><span class="op">[</span><span class="va">index.used</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">count.matrix</span><span class="op">[</span><span class="va">index.used</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span><span class="va">count.matrix</span><span class="op">/</span><span class="va">inter.total</span></span></code></pre></div>
<p>The above results show that ELCIC has the highest selection rate. The
better performance is attributed to its distribution free property,
which is highly valuable in real applications where the underlying
distribution is hard to be correctly specified.</p>
</div>
<div class="section level2">
<h2 id="model-selection-in-longitudinal-data-analysis-assuming-missing-completely-at-random">Model Selection in longitudinal data analysis (assuming missing
completely at random)<a class="anchor" aria-label="anchor" href="#model-selection-in-longitudinal-data-analysis-assuming-missing-completely-at-random"></a>
</h2>
<p>Since ELCIC is distribution free, it is most suitable to statistical
models in semi-parametric framework. This section evaluates how ELCIC
works for joint selection of marginal mean and correlation structures in
longitudinal data analysis. We assume the data is complete or missing
completely at random. The following packages are used to generate
different types of outcomes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PoisNor</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">bindata</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geepack</span><span class="op">)</span></span></code></pre></div>
<p>In the following evaluation, we consider generalized estimating
equations <a href="https://www.jstor.org/stable/2531734?seq=1" class="external-link">GEEs</a>
framework, which is a semi-parametric framework and widely used in
longitudinal data analysis. We jointly select marginal mean and
correlation structures. To be noted, correctly identifying working
correlation structure will be beneficial to estimation efficiency in the
mean structure. We provide a function <code>gee.generator</code> to
generate responses and covariates. Different outcome distributions are
considered in this function including Gaussian, Poisson, and Binomial,
and both time-dependent covariates and time-independent covariates are
allowed in this generator function. We compare ELCIC with another widely
adopted information criterion <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.0006-341X.2001.00120.x" class="external-link">QIC</a>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">28582</span><span class="op">)</span></span>
<span><span class="va">inter.total</span><span class="op">=</span><span class="fl">20</span></span>
<span><span class="va">samplesize</span><span class="op">&lt;-</span><span class="fl">300</span></span>
<span><span class="va">time</span><span class="op">=</span><span class="fl">3</span></span>
<span><span class="va">dist</span><span class="op">=</span><span class="st">"poisson"</span></span>
<span><span class="va">candidate.sets</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">candidate.cor.sets</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"independence"</span>,<span class="st">"exchangeable"</span>,<span class="st">"ar1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">count.matrix.elcic</span><span class="op">&lt;-</span><span class="va">count.matrix.qic</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">candidate.cor.sets</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">candidate.sets</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">count.matrix.elcic</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">count.matrix.qic</span><span class="op">)</span><span class="op">&lt;-</span><span class="va">candidate.cor.sets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">count.matrix.elcic</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">count.matrix.qic</span><span class="op">)</span><span class="op">&lt;-</span><span class="va">candidate.sets</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">iter</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">inter.total</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>    <span class="co">#generate data</span></span>
<span><span class="va">data.corpos</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/gee.generator.html">gee.generator</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,samplesize<span class="op">=</span><span class="va">samplesize</span>,time<span class="op">=</span><span class="va">time</span>,num.time.dep<span class="op">=</span><span class="fl">2</span>,num.time.indep<span class="op">=</span><span class="fl">1</span>,rho<span class="op">=</span><span class="fl">0.4</span>,x.rho<span class="op">=</span><span class="fl">0.2</span>,dist<span class="op">=</span><span class="st">"poisson"</span>,cor.str<span class="op">=</span><span class="st">"exchangeable"</span>,x.cor.str<span class="op">=</span><span class="st">"exchangeable"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="va">data.corpos</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="va">data.corpos</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">id</span><span class="op">&lt;-</span><span class="va">data.corpos</span><span class="op">$</span><span class="va">id</span></span>
<span><span class="va">r</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">samplesize</span><span class="op">*</span><span class="va">time</span><span class="op">)</span></span>
<span></span>
<span><span class="va">criterion.elcic</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ELCIC.gee.html">ELCIC.gee</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,r<span class="op">=</span><span class="va">r</span>,id<span class="op">=</span><span class="va">id</span>,time<span class="op">=</span><span class="va">time</span>,candidate.sets<span class="op">=</span><span class="va">candidate.sets</span>,name.var<span class="op">=</span><span class="cn">NULL</span>,dist<span class="op">=</span><span class="st">"poisson"</span>,candidate.cor.sets<span class="op">=</span><span class="va">candidate.cor.sets</span><span class="op">)</span></span>
<span></span>
<span><span class="va">criterion.qic</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/QICc.gee.html">QICc.gee</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,id<span class="op">=</span><span class="va">id</span>,dist<span class="op">=</span><span class="va">dist</span>,candidate.sets<span class="op">=</span><span class="va">candidate.sets</span>, name.var<span class="op">=</span><span class="cn">NULL</span>, candidate.cor.sets<span class="op">=</span><span class="va">candidate.cor.sets</span><span class="op">)</span></span>
<span></span>
<span><span class="va">index.used.elcic</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">criterion.elcic</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">criterion.elcic</span><span class="op">)</span>,arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">count.matrix.elcic</span><span class="op">[</span><span class="va">index.used.elcic</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">count.matrix.elcic</span><span class="op">[</span><span class="va">index.used.elcic</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span></span>
<span><span class="va">index.used.qic.row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">candidate.cor.sets</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">criterion.qic</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">index.used.qic.col</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">criterion.qic</span><span class="op">)</span></span>
<span><span class="va">count.matrix.qic</span><span class="op">[</span><span class="va">index.used.qic.row</span>,<span class="va">index.used.qic.col</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">count.matrix.qic</span><span class="op">[</span><span class="va">index.used.qic.row</span>,<span class="va">index.used.qic.col</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">iter</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">count.matrix.elcic</span><span class="op">/</span><span class="va">inter.total</span></span>
<span><span class="va">count.matrix.qic</span><span class="op">/</span><span class="va">inter.total</span></span></code></pre></div>
<p>The results above show that ELCIC has much higher power to implement
joint selection, especially for the selection of marginal mean
structure.</p>
</div>
<div class="section level2">
<h2 id="model-selection-in-longitudinal-data-analysis-dropout-missing">Model Selection in longitudinal data analysis (dropout missing)<a class="anchor" aria-label="anchor" href="#model-selection-in-longitudinal-data-analysis-dropout-missing"></a>
</h2>
<p>coming soon</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Chixiang Chen, Biyi Shen, Ming Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
